<span id="moon">ðŸ§€</span>

<script>
  const getMoonPhase = (date = new Date()) => {
    const phases = [
      { emoji: "ðŸŒ‘", name: "New Moon" },
      { emoji: "ðŸŒ’", name: "Waxing Crescent" },
      { emoji: "ðŸŒ“", name: "First Quarter" },
      { emoji: "ðŸŒ”", name: "Waxing Gibbous" },
      { emoji: "ðŸŒ•", name: "Full Moon" },
      { emoji: "ðŸŒ–", name: "Waning Gibbous" },
      { emoji: "ðŸŒ—", name: "Last Quarter" },
      { emoji: "ðŸŒ˜", name: "Waning Crescent" },
    ];
    // 29 days, 12 hours, 44 minutes, and 3 seconds
    const cycleLength = ((3 / 60 + 44) / 60 + 12) / 24 + 29;
    const knownNewMoon = new Date("2022-03-02T18:34:00Z");

    const secondsSinceKnownNewMoon =
      (date.getTime() - knownNewMoon.getTime()) / 1000;
    const daysSinceKnownNewMoon = secondsSinceKnownNewMoon / (60 * 60 * 24);

    const currentMoonPhasePercentage =
      (daysSinceKnownNewMoon % cycleLength) / cycleLength;
    const index = Math.round(currentMoonPhasePercentage * 8) % 8;

    return phases[index];
  };
  const moon = document.querySelector<HTMLParagraphElement>("#moon");
  if (moon) {
    const phase = getMoonPhase();
    moon.textContent = [phase.emoji, phase.name].join(" ");
  }
</script>
